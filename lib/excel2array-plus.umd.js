(function(l,t){typeof exports=="object"&&typeof module<"u"?module.exports=t():typeof define=="function"&&define.amd?define(t):(l=typeof globalThis<"u"?globalThis:l||self,l["excel2array-plus"]=t())})(this,function(){"use strict";const l=/^(\r\n|\n\r|\r|\n)/,t=/^[^\t\r\n]+/,h=/^\t/;function p(e){const i=[[""]];if(e.length===0)return i;let o=0,a=0,r;for(;e.length>0&&r!==e.length;)if(r=e.length,e.match(h))e=e.replace(h,""),o+=1,i[a][o]="";else if(e.match(l))e=e.replace(l,""),o=0,a+=1,i[a]=[""];else{let n="";if(e.startsWith('"')){let c=0,u=!0;for(;u;){const f=e.slice(0,1);f==='"'&&(c+=1),n+=f,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&c%2===0)&&(u=!1)}n=n.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,f=>new Array(Math.floor(f.length/2)).fill('"').join(""))}else{const c=e.match(t);n=c?c[0]:"",e=e.slice(n.length)}i[a][o]=n}return i}return p});
