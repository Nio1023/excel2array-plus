(function(l,t){typeof exports=="object"&&typeof module<"u"?module.exports=t():typeof define=="function"&&define.amd?define(t):(l=typeof globalThis<"u"?globalThis:l||self,l.excelToArray=t())})(this,function(){"use strict";const l=/^(\r\n|\n\r|\r|\n)/,t=/^[^\t\r\n]+/,h=/^\t/;function g(e){const i=[[""]];if(e.length===0)return i;let c=0,f=0,r;for(;e.length>0&&r!==e.length;)if(r=e.length,e.match(h))e=e.replace(h,""),c+=1,i[f][c]="";else if(e.match(l))e=e.replace(l,""),c=0,f+=1,i[f]=[""];else{let n="";if(e.startsWith('"')){let o=0,u=!0;for(;u;){const a=e.slice(0,1);a==='"'&&(o+=1),n+=a,e=e.slice(1),(e.length===0||e.match(/^[\t\r\n]/)&&o%2===0)&&(u=!1)}n=n.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,a=>new Array(Math.floor(a.length/2)).fill('"').join(""))}else{const o=e.match(t);n=o?o[0]:"",e=e.slice(n.length)}i[f][c]=n}return i}return g});
